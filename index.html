<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tabuleiro Imersivo - Educa√ß√£o Sexual</title>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  <style>
        /* [Seu CSS COMPLETO MANTIDO. Removido para brevidade, exceto as regras cr√≠ticas] */

        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100%;
            color: #333;
            overflow-x: auto;
            position: relative;
        }
        /* ... outros estilos ... */

        /* CORRE√á√ÉO CSS CR√çTICA para que o avatar carregue a imagem e oculte o texto/emoji */
        .square-character {
            font-size: 0; 
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 2px solid rgba(255, 255, 255, 0.8);
            margin-bottom: 5px;
        }

        .character-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 0 auto 20px;
            background-size: cover;
            background-position: center;
            border: 4px solid #e2e8f0;
            transition: all 0.3s ease;
            
            /* CORRE√á√ÉO CR√çTICA */
            font-size: 0 !important; 
            text-indent: -9999px; 
            overflow: hidden;
            display: flex; /* Garante que as propriedades de fundo funcionem */
        }
        /* ... (Resto do CSS Original) ... */

        @media (max-width: 768px) {
            /* ... estilos mobile ... */
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><div class="bubbles">
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
   <div class="bubble"></div>
  </div><div id="splashScreen">
   <div class="video-cover">
    <div class="video-thumbnail" id="videoThumbnail">
     <div class="play-button" onclick="startVideo()">
      <div class="play-icon">
       ‚ñ∂Ô∏è
      </div>
      <div class="play-text">
       Assistir Introdu√ß√£o
      </div>
     </div>
     <div class="video-title">
      Tabuleiro Educativo
     </div>
     <div class="video-subtitle">
      Educa√ß√£o Sexual Interativa
     </div>
    </div>
    <video id="introVideo" controls><source src="assets/video/1000007047.mp4" type="video/mp4"> Seu navegador n√£o suporta a reprodu√ß√£o de v√≠deo.
    </video>
    <div class="video-controls" id="videoControls"><button class="btn btn-primary" onclick="startGame()">Iniciar Jogo</button> <button class="btn btn-secondary" onclick="skipVideo()">Pular V√≠deo</button>
    </div>
   </div>
  </div><button id="muteButton" onclick="toggleMute()">üîá</button> <div class="character-card" id="characterCard">
   <div class="character-avatar" id="characterAvatar"></div>
   <div class="character-message" id="characterMessage">
    Boa sorte!
   </div>
  </div><div class="question-modal" id="questionModal">
   <div class="question-content">
    <div class="question-text" id="questionText"></div>
    <div class="question-buttons"><button class="btn-answer" onclick="answerQuestion('V')">VERDADEIRO</button> <button class="btn-answer" onclick="answerQuestion('F')">FALSO</button>
    </div>
   </div>
  </div><div class="explanation-modal" id="explanationModal">
   <div class="explanation-content">
    <div class="explanation-text" id="explanationText"></div><button class="btn-continue" onclick="closeExplanation()">Continuar</button>
   </div>
  </div><div class="game-container" id="gameContainer">
   <div class="game-header">
    <h1 class="game-title" id="gameTitle">Tabuleiro Imersivo - Educa√ß√£o Sexual</h1>
    <p class="instructions" id="instructionsText">Dois jogadores competem no tabuleiro circular! Gire a roleta, mova-se pelas casas e responda perguntas educativas!</p>
   </div><div class="players-stats">
    <div class="player-stat" id="player1Stats">
     <div class="player-name active">
      Jogador 1 - Casa 1
     </div>
     <div class="player-coins">
      ü™ô 0
     </div>
     <div class="player-bombs">
      üí£ 0
     </div>
    </div>
    <div class="player-stat" id="player2Stats">
     <div class="player-name">
      Jogador 2 - Casa 1
     </div>
     <div class="player-coins">
      ü™ô 0
     </div>
     <div class="player-bombs">
      üí£ 0
     </div>
    </div>
   </div><div class="roulette-container">
    <div id="roulette" onclick="spinRoulette()">
     üé≤
    </div>
    <div id="rouletteResult">
     ?
    </div><button class="spin-button" onclick="spinRoulette()"> üé≤ GIRAR ROLETA </button>
   </div><div id="gameBoard"></div>
  </div><audio id="bgm" loop><source src="assets/audio/bgm.mp3"></audio>
  <audio id="sfxCoin"><source src="assets/audio/coin.wav"></audio>
  <audio id="sfxError"><source src="assets/audio/error.mp3"></audio>
  <audio id="sfxWin"><source src="assets/audio/win.wav"></audio>
  <script>
        // --- MAPA DE IMAGENS PERSONALIZADAS (COM SEUS NOMES DE ARQUIVO) ---
        const CHARACTER_IMAGES = {
            'girl_default': 'assets/img/1000007035.png', // Garota Ideia/Default
            'girl_question': 'assets/img/1000007034.png', // Garota Pergunta
            'girl_win': 'assets/img/1000007044.png', // Garota YES!/GOOD JOB!
            'girl_lose': 'assets/img/1000007045.png', // Garota NO!
            'boy_default': 'assets/img/1000007043.png', // Garoto YES! (Usado como default)
            'boy_question': 'assets/img/1000007040.png', // Garoto Pergunta
            'boy_win': 'assets/img/1000007043.png', // Garoto YES!
            'boy_lose': 'assets/img/1000007046.png' // Garoto WHAT?!
        };

        // --- DADOS EDUCATIVOS DO JOGO (mantidos) ---
        const perguntasInformativas = [
            {"pergunta": "√â seguro rasgar a embalagem do preservativo com os dentes para ser mais r√°pido.", "resposta_correta": "F", "explicacao": "FALSO. Rasgar com os dentes ou unhas pode causar microfuros invis√≠veis que anulam a prote√ß√£o. Sempre use os dedos para rasgar na borda serrilhada. Guarde em locais frescos, longe do calor."},
            {"pergunta": "Se colocar o preservativo do lado errado e ele tocar no p√™nis, posso vir√°-lo e usar normalmente.", "resposta_correta": "F", "explicacao": "FALSO. Se come√ßou do lado errado e tocou no p√™nis, jogue fora e pegue outro! Fluidos pr√©-ejaculat√≥rios podem ter entrado em contato com a parte interna."},
            {"pergunta": "√â importante apertar a pontinha do preservativo antes de desenrolar para tirar o ar.", "resposta_correta": "V", "explicacao": "VERDADEIRO. A pontinha √© o reservat√≥rio do esperma. Se n√£o tirar o ar, a press√£o na ejacula√ß√£o pode estourar o preservativo."},
            {"pergunta": "O preservativo protege mesmo se n√£o desenrolar at√© a base do p√™nis.", "resposta_correta": "F", "explicacao": "FALSO. Deve desenrolar completamente at√© a base. √â ali que a borda forma uma 'barreira' que ajuda a prender o esperma e manter a prote√ß√£o."},
            {"pergunta": "Posso retirar o preservativo a qualquer momento ap√≥s a ejacula√ß√£o sem cuidados especiais.", "resposta_correta": "F", "explicacao": "FALSO. Deve ser r√°pido e cuidadoso imediatamente ap√≥s a ejacula√ß√£o, antes do p√™nis amolecer. Segure a borda na base e retire devagar."},
            {"pergunta": "O preservativo feminino pode ser colocado horas antes da rela√ß√£o sexual.", "resposta_correta": "V", "explicacao": "VERDADEIRO. Esta √© uma grande vantagem! Pode ser colocado com anteced√™ncia, tirando a press√£o do momento e garantindo que a prote√ß√£o j√° est√° pronta."},
            {"pergunta": "√â normal o preservativo feminino ficar frouxo ou torcido dentro do canal vaginal.", "resposta_correta": "V", "explicacao": "VERDADEIRO. Essa folga √© normal e permite que ele se ajuste durante a rela√ß√£o. O importante √© que o anel menor esteja bem fundo e o maior cubra a entrada."},
            {"pergunta": "Posso usar preservativo masculino e feminino ao mesmo tempo para maior prote√ß√£o.", "resposta_correta": "F", "explicacao": "FALSO. NUNCA use os dois juntos! O atrito entre os materiais pode rasgar ambos os preservativos. Escolha apenas um."},
            {"pergunta": "O diafragma √© considerado um m√©todo contraceptivo de barreira.", "resposta_correta": "V", "explicacao": "VERDADEIRO. O diafragma (usado com espermicida) e os preservativos s√£o exemplos de m√©todos de barreira que impedem fisicamente a passagem dos espermatozoides."},
            {"pergunta": "A p√≠lula do dia seguinte pode ser usada como m√©todo contraceptivo regular.", "resposta_correta": "F", "explicacao": "FALSO. √â apenas para emerg√™ncias. Usar regularmente causa desequil√≠brios hormonais e √© menos eficaz que m√©todos contraceptivos regulares."},
            {"pergunta": "O preservativo protege contra todas as IST sem exce√ß√£o.", "resposta_correta": "F", "explicacao": "FALSO. Protege contra a maioria, mas IST como HPV e Herpes podem ser transmitidas pelo contato com √°reas da pele n√£o cobertas pelo preservativo."},
            {"pergunta": "O duche vaginal ap√≥s a rela√ß√£o √© eficaz para prevenir gravidez e IST.", "resposta_correta": "F", "explicacao": "FALSO. O duche pode empurrar bact√©rias para dentro do √∫tero e desequilibra a flora vaginal, aumentando o risco de infec√ß√µes."},
            {"pergunta": "O preservativo √© o √∫nico m√©todo que oferece dupla prote√ß√£o: contra gravidez e IST.", "resposta_correta": "V", "explicacao": "VERDADEIRO. √â o √∫nico m√©todo contraceptivo que tamb√©m oferece prote√ß√£o contra a maioria das Infec√ß√µes Sexualmente Transmiss√≠veis."},
            {"pergunta": "O consentimento dado no in√≠cio da rela√ß√£o vale para toda a atividade sexual.", "resposta_correta": "F", "explicacao": "FALSO. O consentimento deve ser cont√≠nuo e pode ser retirado a qualquer momento. Deve ser confirmado em cada etapa da atividade sexual."},
            {"pergunta": "Libido e desejo sexual s√£o exatamente a mesma coisa.", "resposta_correta": "F", "explicacao": "FALSO. Libido √© o impulso sexual geral (o 'motor'), enquanto desejo sexual √© a vontade espec√≠fica de ter atividade sexual (a 'vontade de dirigir')."},
            {"pergunta": "Sexting sem consentimento pode ter consequ√™ncias legais graves.", "resposta_correta": "V", "explicacao": "VERDADEIRO. A distribui√ß√£o n√£o consensual de conte√∫do √≠ntimo (pornografia de vingan√ßa) √© ilegal e pode ter graves consequ√™ncias emocionais e legais."},
            {"pergunta": "Orienta√ß√£o Sexual e Identidade de G√™nero referem-se ao mesmo conceito.", "resposta_correta": "F", "explicacao": "FALSO. Orienta√ß√£o Sexual √© sobre atra√ß√£o por outras pessoas. Identidade de G√™nero √© o sentido interno de ser homem, mulher, ambos, nenhum ou outro g√™nero."},
            {"pergunta": "Uma pessoa sem sintomas vis√≠veis de IST n√£o pode ter nenhuma infec√ß√£o.", "resposta_correta": "F", "explicacao": "FALSO. Muitas IST (como Clam√≠dia e HPV) podem ser assintom√°ticas por muito tempo. Por isso s√£o essenciais os testes regulares e o uso de preservativo."},
            {"pergunta": "Lubrificantes √† base de √≥leo s√£o seguros com preservativos de l√°tex.", "resposta_correta": "F", "explicacao": "FALSO. √ìleos (vaselina, √≥leos de massagem) danificam o l√°tex, tornando o preservativo menos eficaz. Use lubrificantes √† base de √°gua ou silicone."},
            {"pergunta": "√â imposs√≠vel engravidar durante a menstrua√ß√£o.", "resposta_correta": "F", "explicacao": "FALSO. Embora menos prov√°vel, espermatozoides sobrevivem dias no corpo e a ovula√ß√£o pode ocorrer mais cedo em alguns ciclos. Sempre use prote√ß√£o se n√£o deseja engravidar."}
        ];

        const perguntasRisco = [
            {"pergunta": "Verdade ou Mito: Esquecer a p√≠lula anticoncepcional num dia, mas tom√°-la no dia seguinte, anula completamente o risco de gravidez.", "resposta_correta": "F", "explicacao": "FALSO. A efic√°cia da p√≠lula depende da tomada correta e di√°ria. Se voc√™ falhar um dia, a prote√ß√£o pode ser reduzida, e m√©todos de prote√ß√£o adicionais (como o preservativo) devem ser usados nos dias seguintes, conforme as indica√ß√µes m√©dicas."},
            {"pergunta": "√â seguro usar dois preservativos ao mesmo tempo para maior prote√ß√£o.", "resposta_correta": "F", "explicacao": "FALSO. Usar dois preservativos aumenta o atrito entre eles, fazendo com que ambos se rasguem mais facilmente. Use sempre apenas um preservativo de cada vez."},
            {"pergunta": "A p√≠lula do dia seguinte pode ser usada como m√©todo contraceptivo regular.", "resposta_correta": "F", "explicacao": "FALSO. A p√≠lula do dia seguinte √© apenas para emerg√™ncias. Usar regularmente pode causar desequil√≠brios hormonais e √© menos eficaz que m√©todos contraceptivos regulares."},
            {"pergunta": "√â poss√≠vel engravidar mesmo usando preservativo corretamente.", "resposta_correta": "V", "explicacao": "VERDADEIRO. Nenhum m√©todo contraceptivo √© 100% eficaz. O preservativo tem cerca de 98% de efic√°cia quando usado corretamente, mas ainda existe uma pequena possibilidade de falha."},
            {"pergunta": "Toda IST apresenta sintomas vis√≠veis.", "resposta_correta": "F", "explicacao": "FALSO. Muita IST (como Clam√≠dia, HPV e HIV) pode ser assintom√°tica por longos per√≠odos. Por isso √© importante fazer testes regulares e usar sempre preservativo."},
            {"pergunta": "O preservativo protege contra toda IST.", "resposta_correta": "F", "explicacao": "FALSO. O preservativo protege contra a maioria das IST, mas algumas como HPV e Herpes podem ser transmitidas pelo contato com √°reas da pele n√£o cobertas pelo preservativo."},
            {"pergunta": "Lubrificantes √† base de √≥leo s√£o seguros para usar com preservativos de l√°tex.", "resposta_correta": "F", "explicacao": "FALSO. Lubrificantes √† base de √≥leo (como vaselina ou √≥leos de massagem) podem danificar o l√°tex do preservativo, tornando-o menos eficaz e mais propenso a rasgar. Use sempre lubrificantes √† base de √°gua ou silicone com preservativos de l√°tex."},
            {"pergunta": "√â poss√≠vel engravidar tendo rela√ß√£o sexual durante a menstrua√ß√£o.", "resposta_correta": "V", "explicacao": "VERDADEIRO. Embora a probabilidade seja menor, espermatozoides podem sobreviver por v√°rios dias no corpo feminino, e a ovula√ß√£o pode ocorrer mais cedo em alguns ciclos, levando √† gravidez. Sempre use prote√ß√£o se n√£o deseja engravidar."},
            {"pergunta": "IST √© um problema de sa√∫de apenas para pessoas sexualmente ativas com m√∫ltiplos parceiros.", "resposta_correta": "F", "explicacao": "FALSO. Qualquer pessoa sexualmente ativa pode contrair uma IST, independentemente do n√∫mero de parceiros. O risco est√° na pr√°tica sexual desprotegida."},
            {"pergunta": "O sexo anal √© uma pr√°tica de baixo risco para a transmiss√£o de IST em compara√ß√£o com o sexo vaginal.", "resposta_correta": "F", "explicacao": "FALSO. O sexo anal √©, na verdade, uma pr√°tica de alto risco para a transmiss√£o de IST (incluindo o HIV) devido √† maior fragilidade do tecido anal, que pode sofrer microles√µes mais facilmente. O uso correto do preservativo e lubrificante √© essencial."}
        ];

        // Estado do √°udio e jogo
        let isMuted = true;
        let videoStarted = false;
        let currentQuestion = null;
        let currentQuestionCallback = null;

        // Elementos de √°udio
        const bgm = document.getElementById('bgm');
        const sfxCoin = document.getElementById('sfxCoin');
        const sfxError = document.getElementById('sfxError');
        const sfxWin = document.getElementById('sfxWin');

        // Estado do jogo
        let gameState = {
            currentPlayer: 1,
            gameEnded: false,
            players: {
                1: { position: 1, coins: 0, bombs: 0 },
                2: { position: 1, coins: 0, bombs: 0 }
            },
            questionsAnswered: 0,
            isSpinning: false,
            currentRotation: 0
        };

        // Configura√ß√£o padr√£o
        const defaultConfig = {
            video_title: "Tabuleiro Educativo",
            video_subtitle: "Educa√ß√£o Sexual Interativa",
            game_title: "Tabuleiro Imersivo - Educa√ß√£o Sexual",
            instructions_text: "Dois jogadores competem no tabuleiro circular! Gire a roleta, mova-se pelas casas e responda perguntas educativas!"
        };

        // --- FUN√á√ïES DE √ÅUDIO ---
        function playAudio(audioElement, volume = 1.0) {
            if (isMuted) return;
            audioElement.currentTime = 0;
            audioElement.volume = volume;
            audioElement.play().catch(e => console.log("Erro ao tocar √°udio:", e));
        }

        // --- FUN√á√ÉO DE MENSAGEM INLINE (mantida) ---
        function showInlineMessage(message) {
            const messageElement = document.createElement('div');
            messageElement.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(255, 255, 255, 0.95);
                color: #333;
                padding: 20px 30px;
                border-radius: 15px;
                font-size: 1.2rem;
                font-weight: bold;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 2000;
                text-align: center;
                border: 3px solid #667eea;
                backdrop-filter: blur(10px);
            `;
            messageElement.textContent = message;
            document.body.appendChild(messageElement);
            
            setTimeout(() => {
                messageElement.style.opacity = '0';
                messageElement.style.transform = 'translate(-50%, -50%) scale(0.8)';
                setTimeout(() => {
                    if (document.body.contains(messageElement)) {
                        document.body.removeChild(messageElement);
                    }
                }, 300);
            }, 2000);
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteButton').textContent = isMuted ? 'üîá' : 'üîä';
            
            bgm.muted = isMuted;
            sfxCoin.muted = isMuted;
            sfxError.muted = isMuted;
            sfxWin.muted = isMuted;

            if (!isMuted && bgm.paused) {
                bgm.play().catch(e => console.log("Erro ao iniciar BGM:", e));
            }
        }

        // --- FUN√á√ïES DE V√çDEO ---
        function startVideo() {
            const videoThumbnail = document.getElementById('videoThumbnail');
            const video = document.getElementById('introVideo');
            const videoControls = document.getElementById('videoControls');
            const muteButton = document.getElementById('muteButton');
            
            videoThumbnail.style.display = 'none';
            video.style.display = 'block';
            video.classList.add('fade-in');
            
            video.play();
            videoStarted = true;
            
            setTimeout(() => {
                videoControls.style.display = 'flex';
                videoControls.classList.add('slide-up');
                muteButton.style.display = 'block';
                muteButton.classList.add('fade-in');
            }, 1000);
            
            video.addEventListener('ended', function() {
                setTimeout(() => {
                    startGame();
                }, 1000);
            });
        }

        function skipVideo() {
            startGame();
        }

        function startGame() {
            document.getElementById('splashScreen').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splashScreen').style.display = 'none';
                document.getElementById('gameContainer').style.display = 'block';
                document.getElementById('introVideo').pause();
                
                if (!isMuted) {
                    bgm.play().catch(e => console.log("Erro ao iniciar BGM:", e));
                }
                
                document.getElementById('muteButton').style.display = 'block';
                initializeFullGame();
            }, 500);
        }

        // --- FUN√á√ïES DE PERSONAGEM ---
        function setAvatarImage(avatarElement, characterType, state) {
            const imageKey = `${characterType}_${state}`;
            const imagePath = CHARACTER_IMAGES[imageKey];
            
            if (imagePath && avatarElement) {
                // Atribui√ß√£o de imagem via JS
                avatarElement.style.backgroundImage = `url('${imagePath}')`;
                avatarElement.style.backgroundSize = 'cover';
                avatarElement.style.backgroundPosition = 'center';
                // Garante que o texto/emoji seja removido
                avatarElement.textContent = '';
            }
        }

        function showCharacterForHouse(housePosition) {
            const characterCard = document.getElementById('characterCard');
            const avatar = document.getElementById('characterAvatar');
            const message = document.getElementById('characterMessage');
            
            if (characterCard && avatar && message) {
                // Determina o tipo de personagem baseado na casa (par/√≠mpar)
                const characterType = housePosition % 2 === 0 ? 'girl' : 'boy';
                const characterName = characterType === 'girl' ? 'Ana' : 'Jo√£o';
                
                // Remove classes anteriores
                characterCard.classList.remove('happy', 'sad');
                avatar.classList.remove('happy', 'sad');
                message.classList.remove('happy', 'sad');
                
                // Define a imagem de PERGUNTA para o card suspenso
                setAvatarImage(avatar, characterType, 'question');
                message.textContent = `Ol√°! Eu sou ${characterName}! üòä`;
                
                // Mostra o card
                characterCard.classList.add('show');
                
                // Remove ap√≥s 2 segundos
                setTimeout(() => {
                    characterCard.classList.remove('show');
                }, 2000);
            }
        }

        function showCharacterFeedback(isCorrect, characterType = 'girl') {
            const characterCard = document.getElementById('characterCard');
            const avatar = document.getElementById('characterAvatar');
            const message = document.getElementById('characterMessage');
            
            if (characterCard && avatar && message) {
                characterCard.classList.remove('happy', 'sad');
                avatar.classList.remove('happy', 'sad');
                message.classList.remove('happy', 'sad');
                
                if (isCorrect) {
                    characterCard.classList.add('happy');
                    avatar.classList.add('happy');
                    message.classList.add('happy');
                    message.textContent = 'Parab√©ns! üòä';
                    setAvatarImage(avatar, characterType, 'win'); // Imagem de ACERTO
                    playAudio(sfxWin, 0.8);
                } else {
                    characterCard.classList.add('sad');
                    avatar.classList.add('sad');
                    message.classList.add('sad');
                    message.textContent = 'Que pena! üòî';
                    setAvatarImage(avatar, characterType, 'lose'); // Imagem de ERRO
                    playAudio(sfxError, 0.5);
                }
                
                characterCard.classList.add('show');
                
                setTimeout(() => {
                    characterCard.classList.remove('show', 'happy', 'sad');
                    avatar.classList.remove('happy', 'sad');
                    message.classList.remove('happy', 'sad');
                    setAvatarImage(avatar, characterType, 'default');
                    message.textContent = 'Boa sorte!';
                }, 3000);
            }
        }

        // --- SISTEMA DE PERGUNTAS EDUCATIVAS ---
        function sortearPergunta() {
            const todasPerguntas = [...perguntasInformativas, ...perguntasRisco];
            const indice = Math.floor(Math.random() * todasPerguntas.length);
            return todasPerguntas[indice];
        }

        function mostrarPergunta(pergunta, onAnswer) {
            currentQuestion = pergunta;
            currentQuestionCallback = onAnswer;
            
            document.getElementById('questionText').textContent = pergunta.pergunta;
            document.getElementById('questionModal').style.display = 'flex';
        }

        function answerQuestion(resposta) {
            if (!currentQuestion) return;
            
            const acertou = resposta === currentQuestion.resposta_correta;
            const tipoPersonagem = gameState.players[gameState.currentPlayer].position % 2 === 0 ? 'girl' : 'boy';
            
            document.getElementById('questionModal').style.display = 'none';
            
            showCharacterFeedback(acertou, tipoPersonagem);
            
            setTimeout(() => {
                document.getElementById('explanationText').textContent = currentQuestion.explicacao;
                document.getElementById('explanationModal').style.display = 'flex';
            }, 1500);
            
            if (currentQuestionCallback) {
                currentQuestionCallback(acertou);
            }
        }

        function closeExplanation() {
            document.getElementById('explanationModal').style.display = 'none';
            currentQuestion = null;
            currentQuestionCallback = null;
        }

        // --- FUN√á√ïES DO TABULEIRO ---
        function initializeBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            const radius = 250;
            const centerX = 300;
            const centerY = 300;

            for (let i = 1; i <= 40; i++) {
                const square = document.createElement('div');
                square.className = 'square';
                square.id = `square-${i}`;
                
                const angle = ((i - 1) / 40) * 2 * Math.PI - Math.PI / 2;
                const x = centerX + radius * Math.cos(angle);
                const y = centerY + radius * Math.sin(angle);
                
                square.style.left = `${x - 40}px`;
                square.style.top = `${y - 50}px`;
                square.style.animationDelay = `${i * 0.1}s`;
                
                let isGirl = i % 2 === 0;
                let charIcon, labelText;

                if (i === 1) {
                    square.classList.add('start');
                    charIcon = 'üöÄ';
                    labelText = 'IN√çCIO';
                } else if (i === 40) {
                    square.classList.add('finish');
                    charIcon = 'üèÜ';
                    labelText = 'FIM';
                } else {
                    square.classList.add('vf');
                    charIcon = 'üéØ';
                    labelText = 'V/F';
                }

                const character = document.createElement('div');
                character.className = 'square-character';
                // Define a imagem de fundo para o elemento da casa (usando imagem default)
                setAvatarImage(character, isGirl ? 'girl' : 'boy', 'default'); 
                
                const label = document.createElement('div');
                label.className = 'square-number';
                label.textContent = labelText;
                square.appendChild(character);
                square.appendChild(label);

                if (i === 1) {
                    const player1 = document.createElement('div');
                    player1.className = 'player player1';
                    player1.textContent = '1';
                    square.appendChild(player1);
                    
                    const player2 = document.createElement('div');
                    player2.className = 'player player2';
                    player2.textContent = '2';
                    square.appendChild(player2);
                }
                
                board.appendChild(square);
            }
        }

        // Girar a roleta
        function spinRoulette() {
            if (gameState.gameEnded || gameState.isSpinning) return;
            
            gameState.isSpinning = true;
            const roulette = document.getElementById('roulette');
            const result = document.getElementById('rouletteResult');
            
            roulette.classList.add('spinning');
            playAudio(sfxCoin, 0.8);
            
            setTimeout(() => {
                const roll = Math.floor(Math.random() * 6) + 1;
                result.textContent = roll;
                roulette.classList.remove('spinning');
                gameState.isSpinning = false;
                
                movePlayer(roll);
            }, 2000);
        }

        // Mover o jogador
        function movePlayer(steps) {
            const player = gameState.players[gameState.currentPlayer];
            const oldPosition = player.position;
            
            player.position = Math.min(player.position + steps, 40);
            
            const currentSquare = document.getElementById(`square-${oldPosition}`);
            const playerElement = currentSquare.querySelector(`.player.player${gameState.currentPlayer}`);
            if (playerElement) { 
                playerElement.remove(); 
            }
            
            const newSquare = document.getElementById(`square-${player.position}`);
            const newPlayer = document.createElement('div');
            newPlayer.className = `player player${gameState.currentPlayer}`;
            newPlayer.textContent = gameState.currentPlayer;
            newPlayer.style.transform = 'scale(0)';
            newSquare.appendChild(newPlayer);
            
            setTimeout(() => {
                newPlayer.style.transform = 'scale(1)';
                newPlayer.style.transition = 'transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
            }, 100);

            if (player.position >= 40) {
                setTimeout(() => {
                    showGameEnd();
                }, 1000);
                return;
            }

            // Todas as casas (exceto a primeira) t√™m perguntas
            if (player.position > 1) {
                // Primeiro mostra o personagem da casa (Card Suspenso)
                setTimeout(() => {
                    showCharacterForHouse(player.position);
                }, 500);
                
                // Depois mostra a pergunta
                setTimeout(() => {
                    showQuestion();
                }, 2500);
            } else {
                setTimeout(() => {
                    nextPlayer();
                }, 1000);
            }

            updatePlayerDisplay();
        }

        function nextPlayer() {
            gameState.currentPlayer = gameState.currentPlayer === 1 ? 2 : 1;
            updatePlayerDisplay();
            
            showInlineMessage(`Vez do Jogador ${gameState.currentPlayer}! üé≤`);
        }

        function updatePlayerDisplay() {
            const player1Stats = document.getElementById('player1Stats');
            const player2Stats = document.getElementById('player2Stats');
            
            if (player1Stats) {
                const p1 = gameState.players[1];
                player1Stats.innerHTML = `
                    <div class="player-name ${gameState.currentPlayer === 1 ? 'active' : ''}">
                        Jogador 1 - Casa ${p1.position}
                    </div>
                    <div class="player-coins">ü™ô ${p1.coins}</div>
                    <div class="player-bombs">üí£ ${p1.bombs}</div>
                `;
                
                if (gameState.currentPlayer === 1) {
                    player1Stats.classList.add('active');
                } else {
                    player1Stats.classList.remove('active');
                }
            }
            
            if (player2Stats) {
                const p2 = gameState.players[2];
                player2Stats.innerHTML = `
                    <div class="player-name ${gameState.currentPlayer === 2 ? 'active' : ''}">
                        Jogador 2 - Casa ${p2.position}
                    </div>
                    <div class="player-coins">ü™ô ${p2.coins}</div>
                    <div class="player-bombs">üí£ ${p2.bombs}</div>
                `;
                
                if (gameState.currentPlayer === 2) {
                    player2Stats.classList.add('active');
                } else {
                    player2Stats.classList.remove('active');
                }
            }
        }

        function showQuestion() {
            const pergunta = sortearPergunta();
            mostrarPergunta(pergunta, (acertou) => {
                processAnswer(acertou);
            });
        }

        function processAnswer(acertou) {
            const player = gameState.players[gameState.currentPlayer];
            
            if (acertou) {
                player.coins += 10;
                showCoinAnimation();
                playAudio(sfxCoin, 0.7);
            } else {
                player.bombs += 1;
                showBombAnimation();
                playAudio(sfxError, 0.5);
            }
            
            gameState.questionsAnswered += 1;
            updatePlayerDisplay();
            
            setTimeout(() => {
                nextPlayer();
            }, 2000);
        }

        function showCoinAnimation() {
            const coinElement = document.createElement('div');
            coinElement.className = 'coin-animation';
            coinElement.textContent = 'ü™ô';
            document.body.appendChild(coinElement);
            
            setTimeout(() => {
                document.body.removeChild(coinElement);
            }, 1000);
        }

        function showBombAnimation() {
            const bombElement = document.createElement('div');
            bombElement.className = 'bomb-explosion';
            bombElement.textContent = 'üí•';
            document.body.appendChild(bombElement);
            
            setTimeout(() => {
                document.body.removeChild(bombElement);
            }, 1000);
        }

        function showGameEnd() {
            gameState.gameEnded = true;
            const winner = gameState.currentPlayer;
            const winnerData = gameState.players[winner];
            
            setTimeout(() => {
                showInlineMessage(`üèÜ Jogador ${winner} VENCEU! üéâ\n\nü™ô Moedas: ${winnerData.coins}\nüí£ Bombas: ${winnerData.bombs}`);
                
                setTimeout(() => {
                    const restart = confirm(`Jogador ${winner} chegou ao fim!\n\nDeseja jogar novamente?`);
                    if (restart) {
                        restartGame();
                    }
                }, 3000);
            }, 500);
        }

        function restartGame() {
            gameState = {
                currentPlayer: 1,
                gameEnded: false,
                players: {
                    1: { position: 1, coins: 0, bombs: 0 },
                    2: { position: 1, coins: 0, bombs: 0 }
                },
                questionsAnswered: 0,
                isSpinning: false,
                currentRotation: 0
            };
            
            updatePlayerDisplay();
            initializeBoard();
            
            document.getElementById('rouletteResult').textContent = '?';
        }

        // --- INICIALIZA√á√ÉO DO JOGO ---
        function initializeFullGame() {
            console.log("Tabuleiro educativo inicializado!");
            initializeBoard();
            updatePlayerDisplay();
        }

        // --- CONFIGURA√á√ÉO DO ELEMENT SDK (mantida) ---
        async function render(config) {
            const videoTitle = config.video_title || defaultConfig.video_title;
            const videoSubtitle = config.video_subtitle || defaultConfig.video_subtitle;
            const gameTitle = config.game_title || defaultConfig.game_title;
            const instructionsText = config.instructions_text || defaultConfig.instructions_text;

            const titleElement = document.querySelector('.video-title');
            const subtitleElement = document.querySelector('.video-subtitle');
            
            if (titleElement) titleElement.textContent = videoTitle;
            if (subtitleElement) subtitleElement.textContent = videoSubtitle;
            
            document.getElementById('gameTitle').textContent = gameTitle;
            document.getElementById('instructionsText').textContent = instructionsText;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || '#667eea',
                        set: (value) => {
                            config.primary_color = value;
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || 'Segoe UI',
                    set: (value) => {
                        config.font_family = value;
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || 16,
                    set: (value) => {
                        config.font_size = value;
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["video_title", config.video_title || defaultConfig.video_title],
                ["video_subtitle", config.video_subtitle || defaultConfig.video_subtitle],
                ["game_title", config.game_title || defaultConfig.game_title],
                ["instructions_text", config.instructions_text || defaultConfig.instructions_text]
            ]);
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig,
                    render,
                    mapToCapabilities,
                    mapToEditPanelValues
                });
            }
            // Chama a inicializa√ß√£o do jogo para carregar o tabuleiro
            initializeFullGame();
        });
    </script>
 </body>
</html>
